<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>환율 계산기</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      background: #222;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      min-width: 100vw;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .container {
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      min-width: 100vw;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
      align-items: center;
      background: #222;
      box-sizing: border-box;
      padding: 0;
      margin: 0;
    }
    .currency-block {
      width: 100vw;
      max-width: 480px;
      background: #333;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      border-radius: 0 0 18px 18px;
      flex: 0 0 28%;
      min-height: 0;
      justify-content: stretch;
    }
    .currency-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 0;
      padding: 0 24px;
      box-sizing: border-box;
      flex: 1 1 0;
    }
    .currency-label {
      display: flex;
      align-items: center;
      font-size: 1.1em;
      min-width: 0;
    }
    .currency-label img {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      margin-right: 12px;
      flex-shrink: 0;
    }
    .currency-value {
      font-size: 2.1em;
      font-weight: bold;
      letter-spacing: 1px;
      text-align: right;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 55%;
      min-width: 0;
      margin-left: 10px;
    }
    .currency-divider {
      width: 100%;
      height: 3px;
      background: #444;
      margin: 0;
      flex: 0 0 3px;
    }
    .calc-area {
      width: 100vw;
      max-width: 480px;
      background: #222;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: stretch;
      flex: 1 1 72%;
      min-height: 0;
      padding: 0;
      margin: 0;
    }
    .calc-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(5, 1fr);
      gap: 0;
      width: 100vw;
      max-width: 480px;
      height: 100%;
      margin: 0 auto;
      padding: 0;
      flex: 1 1 100%;
    }
    .calc-btn {
      font-size: 1.3em;
      padding: 0;
      border: none;
      border-radius: 0;
      background: #444;
      color: #fff;
      cursor: pointer;
      transition: background 0.2s;
      font-weight: 500;
      outline: none;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
    }
    .calc-btn:active { background: #555; }
    .op, .eq {
      background: #ff9800;
      color: #fff;
    }
    .op:active, .eq:active {
      background: #ffa726;
    }
    @media (max-width: 500px) {
      .currency-block, .calc-area, .calc-buttons { max-width: 100vw; }
      .currency-row { padding-left: 10px; padding-right: 10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="currency-block" id="currency-block">
      <div class="currency-row" id="row-from">
        <div class="currency-label">
          <img id="from-flag" src="https://flagcdn.com/us.svg" alt="USD">
          <span id="from-code">USD</span>
        </div>
        <div class="currency-value" id="from-value">0</div>
      </div>
      <div class="currency-divider"></div>
      <div class="currency-row" id="row-to">
        <div class="currency-label">
          <img id="to-flag" src="https://flagcdn.com/kr.svg" alt="KRW">
          <span id="to-code">KRW</span>
        </div>
        <div class="currency-value" id="to-value">0</div>
      </div>
    </div>
    <div class="calc-area">
      <div class="calc-buttons">
        <button class="calc-btn" onclick="clearAll()">C</button>
        <button class="calc-btn" onclick="backspace()">&larr;</button>
        <button class="calc-btn" onclick="swapCurrency()">&#8597;</button>
        <button class="calc-btn op" onclick="pressOp('/')">÷</button>
        <button class="calc-btn" onclick="pressNum('7')">7</button>
        <button class="calc-btn" onclick="pressNum('8')">8</button>
        <button class="calc-btn" onclick="pressNum('9')">9</button>
        <button class="calc-btn op" onclick="pressOp('*')">×</button>
        <button class="calc-btn" onclick="pressNum('4')">4</button>
        <button class="calc-btn" onclick="pressNum('5')">5</button>
        <button class="calc-btn" onclick="pressNum('6')">6</button>
        <button class="calc-btn op" onclick="pressOp('-')">-</button>
        <button class="calc-btn" onclick="pressNum('1')">1</button>
        <button class="calc-btn" onclick="pressNum('2')">2</button>
        <button class="calc-btn" onclick="pressNum('3')">3</button>
        <button class="calc-btn op" onclick="pressOp('+')">+</button>
        <button class="calc-btn" onclick="pressNum('0')">0</button>
        <button class="calc-btn" onclick="pressDot()">.</button>
        <button class="calc-btn" onclick="pressPercent()">%</button>
        <button class="calc-btn eq" onclick="calculate()">=</button>
      </div>
    </div>
  </div>
  <script>
    // 환율 정보 (예시)
    let rates = {
      'USDKRW': 1438,
      'KRWUSD': 1/1438
    };
    let from = { code: 'USD', flag: 'https://flagcdn.com/us.svg' };
    let to = { code: 'KRW', flag: 'https://flagcdn.com/kr.svg' };
    let input = '0';
    let operator = '';
    let operand = '';
    let justCalculated = false;

    function getRate() {
      return rates[from.code + to.code] || 1;
    }

    function updateUI() {
      document.getElementById('from-flag').src = from.flag;
      document.getElementById('from-code').textContent = from.code;
      document.getElementById('to-flag').src = to.flag;
      document.getElementById('to-code').textContent = to.code;
      document.getElementById('from-value').textContent = input.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
      let fromValue = parseFloat(input) || 0;
      let rate = getRate();
      let toValue = fromValue * rate;
      document.getElementById('to-value').textContent = (fromValue ? toValue.toLocaleString('en-US', {maximumFractionDigits: 0}) : '0');
    }

    function swapCurrency() {
      [from, to] = [to, from];
      input = '0';
      operator = '';
      operand = '';
      justCalculated = false;
      updateUI();
    }

    function clearAll() {
      input = '0';
      operator = '';
      operand = '';
      justCalculated = false;
      updateUI();
    }

    function backspace() {
      if (justCalculated) {
        input = '0';
        justCalculated = false;
      } else {
        input = input.length > 1 ? input.slice(0, -1) : '0';
      }
      updateUI();
    }

    function pressNum(n) {
      if (justCalculated) {
        input = n;
        justCalculated = false;
      } else {
        if (input === '0') input = n;
        else input += n;
      }
      updateUI();
    }

    function pressDot() {
      if (justCalculated) {
        input = '0.';
        justCalculated = false;
      } else if (!input.includes('.')) {
        input += '.';
      }
      updateUI();
    }

    function pressOp(op) {
      if (operator && operand) {
        calculate();
        operand = input;
      } else {
        operand = input;
      }
      operator = op;
      input = '0';
      justCalculated = false;
    }

    function pressPercent() {
      input = (parseFloat(input) / 100).toString();
      updateUI();
    }

    function calculate() {
      let result = 0;
      let a = parseFloat(operand) || 0;
      let b = parseFloat(input) || 0;
      switch (operator) {
        case '+': result = a + b; break;
        case '-': result = a - b; break;
        case '*': result = a * b; break;
        case '/': result = b !== 0 ? a / b : 0; break;
        default: result = b;
      }
      input = result.toString();
      operator = '';
      operand = '';
      justCalculated = true;
      updateUI();
    }

    // 최초 UI 세팅
    updateUI();
  </script>
</body>
</html>
