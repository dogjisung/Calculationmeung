<script>
  async function convert() {
    const usd = parseFloat(document.getElementById("usdInput").value);
    if (isNaN(usd)) {
      alert("숫자를 입력해주세요!");
      return;
    }

    try {
      const apiURL = "https://api.exchangerate.host/latest?base=USD&symbols=KRW";
      const proxyURL = "https://broad-breeze-4af6.jane785714.workers.dev/?url=" + encodeURIComponent(apiURL);

      const res = await fetch(proxyURL);
      const data = await res.json();
      const rate = data.rates.KRW;
      const now = new Date();

      const krw = Math.round(usd * rate).toLocaleString();
      document.getElementById("krwResult").innerText = `${krw} 원`;
      document.getElementById("rateTime").innerText = `1 USD ≒ ${rate.toFixed(3)} KRW (기준: ${now.toLocaleString()})`;
    } catch (e) {
      alert("환율 정보를 가져오는 데 실패했어요. 인터넷 연결 또는 API 상태를 확인해주세요.");
    }
  }
</script>
