<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>환율계산 설정</title>
  <style>
    body {
      margin:0; padding:16px;
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto;
      background:#f9f9f9; color:#222;
    }
    .back {
      cursor:pointer; font-size:24px; display:inline-block;
      margin-bottom:24px;
    }
    .section { margin-bottom:32px; }
    .section h2 {
      margin:0 0 8px; font-size:18px;
    }
    .list {
      list-style:none; padding:0; margin:0;
      border:1px solid #ddd; border-radius:8px;
      background:#fff;
    }
    .list li {
      display:flex; align-items:center;
      padding:12px 16px; cursor:pointer;
      border-bottom:1px solid #eee;
    }
    .list li:last-child { border-bottom:none; }
    .list li .flag { font-size:24px; width:32px; }
    .list li .code { flex:1; margin-left:8px; }
    .list li .radio {
      width:20px; height:20px; border:1px solid #888;
      border-radius:50%; margin-left:12px;
      position:relative;
    }
    .list li.selected .radio::before {
      content:'';
      position:absolute; top:4px; left:4px;
      width:8px; height:8px;
      border-radius:50%; background:#2196f3;
    }
    .controls {
      text-align:right;
    }
    .controls button {
      padding:8px 16px; margin-left:8px;
      font-size:16px; cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="back" onclick="history.back()">← 뒤로</div>

  <div class="section">
    <h2>① 기본 통화 설정</h2>
    <ul id="baseList" class="list"></ul>
  </div>
  <div class="section">
    <h2>② 목적 통화 설정</h2>
    <ul id="tgtList" class="list"></ul>
  </div>
  <div class="section">
    <h2>③ 테마 선택</h2>
    <ul id="themeList" class="list">
      <li data-theme=""   class=""><span class="code">기본</span><div class="radio"></div></li>
      <li data-theme="dark" class=""><span class="code">다크</span><div class="radio"></div></li>
      <li data-theme="pastel" class=""><span class="code">파스텔</span><div class="radio"></div></li>
      <li data-theme="mono"   class=""><span class="code">모노</span><div class="radio"></div></li>
    </ul>
  </div>
  <div class="controls">
    <button id="saveBtn">저장</button>
    <button id="cancelBtn" onclick="history.back()">취소</button>
  </div>

  <script>
    const FLAGS = {
      KRW:'🇰🇷', USD:'🇺🇸', EUR:'🇪🇺', JPY:'🇯🇵',
      CNY:'🇨🇳', VND:'🇻🇳', THB:'🇹🇭', PHP:'🇵🇭',
      RUB:'🇷🇺', HKD:'🇭🇰'
    };
    const CODES = Object.keys(FLAGS);
    const baseList = document.getElementById('baseList'),
          tgtList  = document.getElementById('tgtList'),
          themeList= document.getElementById('themeList'),
          saveBtn  = document.getElementById('saveBtn');

    const STORAGE = {
      base: localStorage.getItem('base')   || 'USD',
      target:localStorage.getItem('target')|| 'KRW',
      theme: localStorage.getItem('theme') || ''
    };

    function makeList(container, key){
      CODES.forEach(code=>{
        const li = document.createElement('li');
        li.dataset.code = code;
        li.innerHTML = `<span class="flag">${FLAGS[code]}</span>
                        <span class="code">${code}</span>
                        <div class="radio"></div>`;
        li.addEventListener('click',()=>{
          // 선택표시
          container.querySelectorAll('li').forEach(x=>x.classList.remove('selected'));
          li.classList.add('selected');
        });
        container.appendChild(li);
      });
      // 초기 선택
      container.querySelector(`li[data-code="${STORAGE[key]}"]`)
               .classList.add('selected');
    }

    // 테마 리스트 선택 처리
    themeList.querySelectorAll('li').forEach(li=>{
      if(li.dataset.theme===STORAGE.theme) li.classList.add('selected');
      li.addEventListener('click',()=>{
        themeList.querySelectorAll('li').forEach(x=>x.classList.remove('selected'));
        li.classList.add('selected');
      });
    });

    // 기본/목적 리스트 생성
    makeList(baseList, 'base');
    makeList(tgtList,  'target');

    saveBtn.addEventListener('click',()=>{
      const selBase = baseList.querySelector('li.selected').dataset.code;
      const selTgt  = tgtList.querySelector('li.selected').dataset.code;
      const selTheme= themeList.querySelector('li.selected').dataset.theme;
      localStorage.setItem('base', selBase);
      localStorage.setItem('target', selTgt);
      localStorage.setItem('theme', selTheme);
      alert('설정이 저장되었습니다.');
      history.back();
    });
  </script>
</body>
</html>
