<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>환율계산 설정</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto;
      margin: 0; padding: 20px;
    }
    h2 {
      font-size: 20px;
      margin-bottom: 20px;
    }
    select {
      width: 100%;
      font-size: 16px;
      padding: 8px;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }
    .row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .row img {
      width: 24px;
      height: 18px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px 5px 0 0;
    }
  </style>
</head>
<body>
  <h2 onclick="location.href='index.html'" style="cursor:pointer">← 뒤로</h2>

  <div class="row">
    <label>① 기본 통화</label>
  </div>
  <div class="row">
    <img id="flag1" src="https://flagcdn.com/us.svg" />
    <select id="baseCurrency"></select>
  </div>

  <div class="row">
    <label>② 목적 통화</label>
  </div>
  <div class="row">
    <img id="flag2" src="https://flagcdn.com/kr.svg" />
    <select id="targetCurrency"></select>
  </div>

  <div class="row">
    <label>③ 테마 선택</label>
    <select id="theme">
      <option value="">기본</option>
      <option value="dark">다크</option>
      <option value="pastel">파스텔</option>
      <option value="mono">모노</option>
    </select>
  </div>

  <div class="row">
    <label id="rateLabel">④ 직접 환율 입력 (1 USD → KRW)</label>
  </div>
  <input type="text" id="customRate" placeholder="예) 1432" />

  <div>
    <button onclick="save()">저장</button>
    <button onclick="reset()">초기화</button>
  </div>

  <script>
    const currencies = {
      KRW: "🇰🇷",
      USD: "🇺🇸",
      EUR: "🇪🇺",
      JPY: "🇯🇵",
      CNY: "🇨🇳",
      VND: "🇻🇳",
      THB: "🇹🇭",
      PHP: "🇵🇭",
      RUB: "🇷🇺",
      HKD: "🇭🇰",
    };

    const baseSelect = document.getElementById("baseCurrency");
    const targetSelect = document.getElementById("targetCurrency");
    const themeSelect = document.getElementById("theme");
    const flag1 = document.getElementById("flag1");
    const flag2 = document.getElementById("flag2");
    const rateLabel = document.getElementById("rateLabel");
    const customRateInput = document.getElementById("customRate");

    for (const code in currencies) {
      const option1 = new Option(code, code);
      const option2 = new Option(code, code);
      baseSelect.add(option1);
      targetSelect.add(option2);
    }

    function updateFlagsAndLabel() {
      flag1.src = `https://flagcdn.com/${baseSelect.value.slice(0, 2).toLowerCase()}.svg`;
      flag2.src = `https://flagcdn.com/${targetSelect.value.slice(0, 2).toLowerCase()}.svg`;
      rateLabel.innerText = `④ 직접 환율 입력 (1 ${baseSelect.value} → ${targetSelect.value})`;
    }

    function save() {
      localStorage.setItem("base", baseSelect.value);
      localStorage.setItem("target", targetSelect.value);
      localStorage.setItem("theme", themeSelect.value);
      localStorage.setItem("customRate", customRateInput.value);
      alert("설정이 저장되었습니다.");
    }

    function reset() {
      localStorage.removeItem("base");
      localStorage.removeItem("target");
      localStorage.removeItem("theme");
      localStorage.removeItem("customRate");
      location.reload();
    }

    function load() {
      baseSelect.value = localStorage.getItem("base") || "USD";
      targetSelect.value = localStorage.getItem("target") || "KRW";
      themeSelect.value = localStorage.getItem("theme") || "";
      customRateInput.value = localStorage.getItem("customRate") || "";
      updateFlagsAndLabel();
    }

    baseSelect.addEventListener("change", updateFlagsAndLabel);
    targetSelect.addEventListener("change", updateFlagsAndLabel);

    window.addEventListener("load", load);
    window.addEventListener("popstate", () => {
      location.href = "index.html";
    });
    history.pushState(null, null, location.href);
  </script>
</body>
</html>
